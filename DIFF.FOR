C   ./ i 0
$STORAGE:2
      SUBROUTINE DIFF
C
C     CHART SUBROUTINE FOR HYPOXIA.  CHART 6
C
      REAL M
      CHARACTER*4 NAME
      DIMENSION T PO2 (4)
      COMMON ICOM1(176), NAME(7),ISTUDY,IDATE(3),IFLAG(75),NVAR,NTABLE,
     A   PARAM(75),  ICOM2(96)
      EQUIVALENCE (CAP PO2,PARAM(20)), (TISS R,PARAM(61)),
     A   (T PO2(1),PARAM(62)), (CAP R,PARAM(66))
C
      DATA M /714285.714/
C
C***************************************
C     SUBROUTINE TISSUE    CHART 6
C     TISSUE O2 EQUATION FROM TENNEY, RESP. PHYSIOL., 20.283, 1974.
C
C     CAP R = RADIUS OF CAPILLARY (0.0005 CM DEFAULT NORMAL)
C     M     = Q (O2) / 2 * D (O2)
C       WHERE Q (O2) = METABOLICRATE OF TISSUE.  RESTING SKELETAL
C       MUSCLE IS 0.4 E-4 ML/ML-SEC(FROM TENNEY), AND
C       IS 0.5 E-3 FROM KETY, 1957.  WE USE KETY'S VALUE
C AND D (O2) = KROUGH'S TISSUE DIFFUSION COEFF. FOR O2, THE
C       COEFF = 3.5 E-10 SQ. CM./SEC/MM HG
C     TISSR = RADIUS OF DIFFUSION CYLINDER IN TISSUE.  NORMAL IS
C      O.OO3 - 0.004 CM.
C
C     THIS COMPUTATION IS PERFORMED FOR 4 VALUES OF TISSUE R, STARTING
C        AT THE GIVEN R & THEN FOR 3 VALUES MORE IN 0.001 INCREMENTS.
C        DEFAULT NORMAL R IS 0.002 CM.
C
      R = TISS R
      CAP RSQ = CAP R * CAP R
      DO 100  K2 = 1,4
      RSQ DIF = R * R - CAP RSQ
      T PO2 (K2) = CAP PO2 + M * (0.375 * RSQ DIF -
     A   0.5 * R ** 4.0 * ALOG (R /CAP R) / RSQ DIF)
      IF (T PO2 (K2) .LT. 0.0)  T PO2 (K2) = 0.0
      IFLAG (K2 + 61) = 3
      R = R + 0.001
  100 CONTINUE
      RETURN
      END
